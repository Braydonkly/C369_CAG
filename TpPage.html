<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Top-Up</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .custom-button {
            background-color: black;
            color: white;
            padding: 10px 20px;
            border: none;
            font-size: 15px;
            border-radius: 20px;
            text-decoration: none;
            display: inline-block;
            margin-top: 20px;
        }
        .custom-button:hover {
            text-decoration: none;
            color:black;
            background-color: white;
            border: 2px solid black;
        }

        .tab-content {
            margin-top: 20px;
        }
        .form-label {
            margin-top: 10px;
        }
        .balance-display {
            font-size: 1.5em;
            color: red;
        }
        .conversion-rate {
            font-size: 0.9em;
            color: gray;
            margin-top: 10px;
            padding: -15px;
        }
        .form-control {
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <img src="logo.png" alt="Logo" width="30" height="30">
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavDropdown">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="overview.html">Services</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="contact.html">Contact Us</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="CreateAcc.html">Sign Up</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="login.html">Login</a>
                    </li>
                    <li class="nav-item">
                        <a href="QR.html">
                        <img src="PayQr.jpeg" alt="Qr Code" class="qr-image" width="30" height="30" style="vertical-align: middle; margin-left: 15px;">
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    
    <div class="container mt-4">
        <div class="row align-items-center">
            <div class="col">
                <h1>Top-up the account</h1>
            </div>
            <div class="col text-end">
                <a href="THistory.html" class="custom-button">Transaction History</a>
            </div>
        </div>
    
        <ul class="nav nav-tabs" id="currencyTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="eur-tab" data-bs-toggle="tab" data-bs-target="#eur" type="button" role="tab" aria-controls="eur" aria-selected="true">EUR</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="cny-tab" data-bs-toggle="tab" data-bs-target="#cny" type="button" role="tab" aria-controls="cny" aria-selected="false">CNY</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="jpy-tab" data-bs-toggle="tab" data-bs-target="#jpy" type="button" role="tab" aria-controls="jpy" aria-selected="false">JPY</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="gbp-tab" data-bs-toggle="tab" data-bs-target="#gbp" type="button" role="tab" aria-controls="gbp" aria-selected="false">GBP</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="inr-tab" data-bs-toggle="tab" data-bs-target="#inr" type="button" role="tab" aria-controls="inr" aria-selected="false">INR</button>
            </li>
        </ul>
        <div class="tab-content" id="currencyTabContent">
            <div class="tab-pane fade show active" id="eur" role="tabpanel" aria-labelledby="eur-tab">
                <h3>Select Top-Up Amount:</h3>
                <form id="topup-form-eur">
                    <div class="radio-group">
                        <label><input type="radio" name="topupAmountEUR" value="50"> 33.56 EUR = 50 SGD</label><br>
                        <label><input type="radio" name="topupAmountEUR" value="100"> 67.11 EUR = 100 SGD</label><br>
                        <label><input type="radio" name="topupAmountEUR" value="500"> 335.57 EUR = 500 SGD</label><br>
                        <label><input type="radio" name="topupAmountEUR" value="1000"> 671.14 EUR = 1000 SGD</label><br>
                        <label><input type="radio" name="topupAmountEUR" value="5000"> 3355.70 EUR = 5000 SGD</label><br>
                        <label><input type="radio" name="topupAmountEUR" value="10000"> 6711.41 EUR = 10000 SGD</label><br>
                        <label><input type="radio" name="topupAmountEUR" value="custom"> Custom Amount: <input type="number" id="customAmountEUR" placeholder="Enter amount in SGD" class="form-control" style="display:inline-block; width:auto;"></label><br>
                    </div>
                    <button type="submit" class="custom-button">Top-Up</button>
                </form>
            </div>
            <div class="tab-pane fade" id="cny" role="tabpanel" aria-labelledby="cny-tab">
                <h3>Select Top-Up Amount:</h3>
                <form id="topup-form-cny">
                    <div class="radio-group">
                        <label><input type="radio" name="topupAmountCNY" value="50"> 312.50 CNY = 50 SGD</label><br>
                        <label><input type="radio" name="topupAmountCNY" value="100"> 625.00 CNY = 100 SGD</label><br>
                        <label><input type="radio" name="topupAmountCNY" value="500"> 3125.00 CNY = 500 SGD</label><br>
                        <label><input type="radio" name="topupAmountCNY" value="1000"> 6250.00 CNY = 1000 SGD</label><br>
                        <label><input type="radio" name="topupAmountCNY" value="5000"> 31250.00 CNY = 5000 SGD</label><br>
                        <label><input type="radio" name="topupAmountCNY" value="10000"> 62500.00 CNY = 10000 SGD</label><br>
                        <label><input type="radio" name="topupAmountCNY" value="custom"> Custom Amount: <input type="number" id="customAmountCNY" placeholder="Enter amount in SGD" class="form-control" style="display:inline-block; width:auto;"></label><br>
                    </div>
                    <button type="submit" class="custom-button">Top-Up</button>
                </form>
            </div>

            <div class="tab-pane fade" id="jpy" role="tabpanel" aria-labelledby="jpy-tab">
                <h3>Select Top-Up Amount:</h3>
                <form id="topup-form-jpy">
                    <div class="radio-group">
                        <label><input type="radio" name="topupAmountJPY" value="50"> 5882.35 JPY = 50 SGD</label><br>
                        <label><input type="radio" name="topupAmountJPY" value="100"> 11764.71 JPY = 100 SGD</label><br>
                        <label><input type="radio" name="topupAmountJPY" value="500"> 58823.53 JPY = 500 SGD</label><br>
                        <label><input type="radio" name="topupAmountJPY" value="1000"> 117647.06 JPY = 1000 SGD</label><br>
                        <label><input type="radio" name="topupAmountJPY" value="5000"> 588235.29 JPY = 5000 SGD</label><br>
                        <label><input type="radio" name="topupAmountJPY" value="10000"> 1176470.59 JPY = 10000 SGD</label><br>
                        <label><input type="radio" name="topupAmountJPY" value="custom"> Custom Amount: <input type="number" id="customAmountJPY" placeholder="Enter amount in SGD" class="form-control" style="display:inline-block; width:auto;"></label><br>
                    </div>
                    <button type="submit" class="custom-button">Top-Up</button>
                </form>
            </div>

            <div class="tab-pane fade" id="gbp" role="tabpanel" aria-labelledby="gbp-tab">
                <h3>Select Top-Up Amount:</h3>
                <form id="topup-form-gbp">
                    <div class="radio-group">
                        <label><input type="radio" name="topupAmountGBP" value="50"> 29.24 GBP = 50 SGD</label><br>
                        <label><input type="radio" name="topupAmountGBP" value="100"> 58.48 GBP = 100 SGD</label><br>
                        <label><input type="radio" name="topupAmountGBP" value="500"> 292.40 GBP = 500 SGD</label><br>
                        <label><input type="radio" name="topupAmountGBP" value="1000"> 584.80 GBP = 1000 SGD</label><br>
                        <label><input type="radio" name="topupAmountGBP" value="5000"> 2924.00 GBP = 5000 SGD</label><br>
                        <label><input type="radio" name="topupAmountGBP" value="10000"> 5848.01 GBP = 10000 SGD</label><br>
                        <label><input type="radio" name="topupAmountGBP" value="custom"> Custom Amount: <input type="number" id="customAmountGBP" placeholder="Enter amount in SGD" class="form-control" style="display:inline-block; width:auto;"></label><br>
                    </div>
                    <button type="submit" class="custom-button">Top-Up</button>
                </form>
            </div>
    
            <div class="tab-pane fade" id="inr" role="tabpanel" aria-labelledby="inr-tab">
                <h3>Select Top-Up Amount:</h3>
                <form id="topup-form-inr">
                    <div class="radio-group">
                        <label><input type="radio" name="topupAmountINR" value="50"> 3125.00 INR = 50 SGD</label><br>
                        <label><input type="radio" name="topupAmountINR" value="100"> 6250.00 INR = 100 SGD</label><br>
                        <label><input type="radio" name="topupAmountINR" value="500"> 31250.00 INR = 500 SGD</label><br>
                        <label><input type="radio" name="topupAmountINR" value="1000"> 62500.00 INR = 1000 SGD</label><br>
                        <label><input type="radio" name="topupAmountINR" value="5000"> 312500.00 INR = 5000 SGD</label><br>
                        <label><input type="radio" name="topupAmountINR" value="10000"> 625000.00 INR = 10000 SGD</label><br>
                        <label><input type="radio" name="topupAmountINR" value="custom"> Custom Amount: <input type="number" id="customAmountINR" placeholder="Enter amount in SGD" class="form-control" style="display:inline-block; width:auto;"></label><br>
                    </div>
                    <button type="submit" class="custom-button">Top-Up</button>
                </form>
            </div>
        </div>

        <div class="mt-4">
            <h3>Total Balance: <span class="balance-display" id="total-balance">50.0 SGD</span></h3>
            <form>
                <div class="mb-3">
                    <label for="balance-limit" class="form-label">Set Balance Limit in SGD:</label>
                    <input type="number" class="form-control" id="balance-limit" name="balance-limit" required>
                </div>
                <button type="button" class="custom-button" onclick="setBalanceLimit()">Set Limit</button>
            </form>
            <p class="conversion-rate">Subjected to Trading Fees + Platform Fees</p>
        </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        
        let balanceLimit = 0;

    window.onload = function() {
        const storedBalance = localStorage.getItem('accountBalance');
        if (storedBalance) {
            document.getElementById('total-balance').textContent = storedBalance + ' SGD';
            updateBalanceColor(parseFloat(storedBalance));
        } else {
            document.getElementById('total-balance').textContent = '0.00 SGD';
        }

    
        const storedLimit = localStorage.getItem('balanceLimit');
        if (storedLimit) {
            balanceLimit = parseFloat(storedLimit);
            document.getElementById('balance-limit').value = balanceLimit;
        }
    };

    function addToTransactionHistory(amount) {
        let history = JSON.parse(localStorage.getItem('transactionHistory')) || [];

        const newTransaction = {
            date: new Date().toLocaleString(),
            amount: amount,
            type: '+'
        };

        history.push(newTransaction);
        localStorage.setItem('transactionHistory', JSON.stringify(history));
    }

    document.getElementById('topup-form-eur').addEventListener('submit', function(event) {
        event.preventDefault();
        handleTopUp('topupAmountEUR', 'customAmountEUR', 1.49);
    });

    document.getElementById('topup-form-cny').addEventListener('submit', function(event) {
        event.preventDefault();
        handleTopUp('topupAmountCNY', 'customAmountCNY', 0.16);
    });

    document.getElementById('topup-form-jpy').addEventListener('submit', function(event) {
        event.preventDefault();
        handleTopUp('topupAmountJPY', 'customAmountJPY', 0.0085);
    });

    document.getElementById('topup-form-gbp').addEventListener('submit', function(event) {
        event.preventDefault();
        handleTopUp('topupAmountGBP', 'customAmountGBP', 1.71);
    });

    document.getElementById('topup-form-inr').addEventListener('submit', function(event) {
        event.preventDefault();
        handleTopUp('topupAmountINR', 'customAmountINR', 0.016);
    });

    function handleTopUp(radioName, customInputId, conversionRate) {
        let selectedAmountSGD;

        const customAmountInput = document.getElementById(customInputId);
        const selectedRadio = document.querySelector(`input[name="${radioName}"]:checked`);

        if (selectedRadio.value === 'custom') {
            selectedAmountSGD = parseFloat(customAmountInput.value);
            if (isNaN(selectedAmountSGD) || selectedAmountSGD <= 0) {
                alert('Please enter a valid amount');
                return;
            }
        } else {
            selectedAmountSGD = parseFloat(selectedRadio.value);
        }

        const currentBalanceElement = document.getElementById('total-balance');
        let currentBalance = parseFloat(currentBalanceElement.textContent.split(' ')[0]);

        const selectedAmountOriginal = selectedAmountSGD / conversionRate;

        currentBalance += selectedAmountSGD;
        currentBalanceElement.textContent = currentBalance.toFixed(2) + ' SGD';

        localStorage.setItem('accountBalance', currentBalance.toFixed(2));

        updateBalanceColor(currentBalance);

        addToTransactionHistory(selectedAmountSGD); 

        alert(`Top-Up of ${selectedAmountSGD} SGD (equivalent to ${selectedAmountOriginal.toFixed(2)} in original currency) Successful`);
    }

    function setBalanceLimit() {
        balanceLimit = parseFloat(document.getElementById('balance-limit').value);
        localStorage.setItem('balanceLimit', balanceLimit);
        alert('Balance limit set to ' + balanceLimit + ' SGD');
        const currentBalance = parseFloat(document.getElementById('total-balance').textContent.split(' ')[0]);
        updateBalanceColor(currentBalance);
    }

    function updateBalanceColor(currentBalance) {
        const currentBalanceElement = document.getElementById('total-balance');
        if (currentBalance < balanceLimit) {
            currentBalanceElement.style.color = 'red';
        } else {
            currentBalanceElement.style.color = 'black';
        }
    }




    </script>
</body>
</html>
